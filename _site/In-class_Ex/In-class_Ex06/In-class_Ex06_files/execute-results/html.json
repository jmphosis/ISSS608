{
  "hash": "2f7f081bdda6439933f8754bbf227a94",
  "result": {
    "markdown": "---\ntitle: \"In-class Exercise 6\"\nauthor: \"Janet Toa\"\ndate: \"24 February 2024\"\ndate-modified: \"last-modified\" #allows for updating to the latest date\nformat: html\nexecute: \n  echo: true #shows the code\n  eval: true #shows the outcomes of the code\n  warning: false #does not show the warnings\neditor: visual\nbackground-color: lightgrey;\nfont-family:  Palatino Linotype;\n---\n\n\n# 20 Time on the Horizon: ggHoriPlot Methods\n\n## 20.1 Overview and Learning Outcomes\n\nThis hands-on exercise is based on [Chapter 20](https://r4va.netlify.app/chap20) of the **R for Visual Analytics** book.\n\nA horizon graph is an analytical graphical method specially designed for visualising large numbers of time-series. It aims to overcome the issue of visualising highly overlapping time-series.\n\nA horizon graph essentially an area chart that has been split into slices and the slices then layered on top of one another with the areas representing the highest (absolute) values on top. Each slice has a greater intensity of colour based on the absolute value it represents.\n\nThe learning outcome is to plot a horizon graph using the [**ggHoriPlot**](https://rivasiker.github.io/ggHoriPlot/) package.\n\n## 20.2 Getting Started\n\n### 20.2.1 Installing and Loading Required Libraries\n\nIn this hands-on exercise, the following R packages are used:\n\n-   [**tidyverse**](https://www.tidyverse.org/) (i.e. readr, tidyr, dplyr) for performing data science tasks such as importing, tidying, and wrangling data;\n-   [**ggthemes**](https://ggplot2.tidyverse.org/reference/ggtheme.html) for extra themes, geoms, and scales for ggplot2; and\n-   [**ggHoriPlot**](https://rivasiker.github.io/ggHoriPlot/) for plotting horizon plots for ggplot2.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggHoriPlot, ggthemes, tidyverse)\n```\n:::\n\n\n### 20.2.2 Importing Data\n\nIn this in-class exercise, the [Average Retail Prices Of Selected Consumer Items](https://tablebuilder.singstat.gov.sg/table/TS/M212891) dataset will be used. The csv file, AVERP, is imported into the R environment using the read_csv() function in the **readr** package.\n\n> Note: By default, the read_csv() function will import data in the \"Date\" field as a character data type. The [`dmy()`](https://lubridate.tidyverse.org/reference/ymd.html) function in the [**lubridate**](https://lubridate.tidyverse.org/) package is used to change the \"Date\" field into the appropriate date data type.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naverp = read_csv(\"data/AVERP.csv\") %>%\n  mutate(`Date` = dmy(`Date`))\n```\n:::\n\n\n## 20.3 Plotting Horizon Graph\n\nThe horizon graph is then plotted below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naverp %>% \n  # from 2018 onwards\n  filter(Date >= \"2018-01-01\") %>%\n  ggplot() +\n  geom_horizon(aes(x = Date, y=Values), \n               origin = \"midpoint\", \n               horizonscale = 6)+\n  # to create one row for one item\n  facet_grid(`Consumer Items`~.) +\n  # theme that use minimal no. of fields posible\n    theme_few() +\n  # diverging colours used to get good separation of values above and below reference point\n  scale_fill_hcl(palette = 'RdBu') +\n  theme(panel.spacing.y=unit(0, \"lines\"), strip.text.y = element_text(\n    size = 5, angle = 0, hjust = 0),\n    legend.position = 'none',\n    axis.text.y = element_blank(),\n    axis.text.x = element_text(size=7),\n    axis.title.y = element_blank(),\n    axis.title.x = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.border = element_blank()\n    ) +\n    scale_x_date(expand=c(0,0), date_breaks = \"3 month\", date_labels = \"%b%y\") +\n  ggtitle('Average Retail Prices of Selected Consumer Items (Jan 2018 to Dec 2022)')\n```\n\n::: {.cell-output-display}\n![](In-class_Ex06_files/figure-html/unnamed-chunk-3-1.png){width=1152}\n:::\n:::\n\n\n[**\\~\\~\\~ End of In-class Exercise 6 \\~\\~\\~**]{.smallcaps}\n",
    "supporting": [
      "In-class_Ex06_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}